{"ast":null,"code":"// frontend/src/admin/pages/MessagesPage.js\nimport React,{useState,useEffect}from'react';import axios from'axios';import'../styles/MessagesPage.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const MessagesPage=()=>{const[messages,setMessages]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[selectedMessage,setSelectedMessage]=useState(null);// Fetch messages\nuseEffect(()=>{const fetchMessages=async()=>{try{const token=localStorage.getItem('token');// Assuming you store auth token in localStorage\nconst response=await axios.get('/api/messages',{headers:{Authorization:`Bearer ${token}`}});setMessages(response.data.data);setLoading(false);}catch(error){var _error$response,_error$response$data;setError(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.message)||'Error fetching messages');setLoading(false);}};fetchMessages();},[]);// Mark message as read\nconst markAsRead=async id=>{try{const token=localStorage.getItem('token');await axios.patch(`/api/messages/${id}/read`,{},{headers:{Authorization:`Bearer ${token}`}});// Update local state\nsetMessages(messages.map(message=>message._id===id?{...message,isRead:true}:message));}catch(error){console.error('Error marking message as read:',error);}};// Delete message\nconst deleteMessage=async id=>{if(!window.confirm('Are you sure you want to delete this message?'))return;try{const token=localStorage.getItem('token');await axios.delete(`/api/messages/${id}`,{headers:{Authorization:`Bearer ${token}`}});// Update local state\nsetMessages(messages.filter(message=>message._id!==id));// Close message detail if it's the deleted one\nif(selectedMessage&&selectedMessage._id===id){setSelectedMessage(null);}}catch(error){console.error('Error deleting message:',error);}};// View message details\nconst viewMessage=message=>{setSelectedMessage(message);// If message is unread, mark it as read\nif(!message.isRead){markAsRead(message._id);}};// Close message detail\nconst closeMessageDetail=()=>{setSelectedMessage(null);};// Format date\nconst formatDate=dateString=>{const options={year:'numeric',month:'short',day:'numeric',hour:'2-digit',minute:'2-digit'};return new Date(dateString).toLocaleDateString(undefined,options);};if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"loading\",children:\"Loading messages...\"});if(error)return/*#__PURE__*/_jsxs(\"div\",{className:\"error-message\",children:[\"Error: \",error]});return/*#__PURE__*/_jsxs(\"div\",{className:\"admin-messages-page\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Messages\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"messages-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"messages-list\",children:messages.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"no-messages\",children:\"No messages yet\"}):messages.map(message=>/*#__PURE__*/_jsxs(\"div\",{className:`message-item ${message.isRead?'':'unread'} ${selectedMessage&&selectedMessage._id===message._id?'selected':''}`,onClick:()=>viewMessage(message),children:[/*#__PURE__*/_jsx(\"div\",{className:\"message-sender\",children:message.name}),/*#__PURE__*/_jsx(\"div\",{className:\"message-subject\",children:message.subject}),/*#__PURE__*/_jsx(\"div\",{className:\"message-preview\",children:message.message.length>60?`${message.message.substring(0,60)}...`:message.message}),/*#__PURE__*/_jsx(\"div\",{className:\"message-date\",children:formatDate(message.createdAt)})]},message._id))}),selectedMessage&&/*#__PURE__*/_jsxs(\"div\",{className:\"message-detail\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"message-detail-header\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"close-button\",onClick:closeMessageDetail,children:\"\\xD7\"}),/*#__PURE__*/_jsx(\"h2\",{children:selectedMessage.subject}),/*#__PURE__*/_jsxs(\"div\",{className:\"message-meta\",children:[/*#__PURE__*/_jsxs(\"span\",{className:\"from\",children:[\"From: \",selectedMessage.name,\" <\",selectedMessage.email,\">\"]}),/*#__PURE__*/_jsxs(\"span\",{className:\"date\",children:[\"Date: \",formatDate(selectedMessage.createdAt)]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"message-body\",children:selectedMessage.message}),/*#__PURE__*/_jsxs(\"div\",{className:\"message-actions\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"delete-button\",onClick:()=>deleteMessage(selectedMessage._id),children:\"Delete\"}),/*#__PURE__*/_jsx(\"a\",{href:`mailto:${selectedMessage.email}?subject=Re: ${selectedMessage.subject}`,className:\"reply-button\",children:\"Reply\"})]})]})]})]});};export default MessagesPage;","map":{"version":3,"names":["React","useState","useEffect","axios","jsx","_jsx","jsxs","_jsxs","MessagesPage","messages","setMessages","loading","setLoading","error","setError","selectedMessage","setSelectedMessage","fetchMessages","token","localStorage","getItem","response","get","headers","Authorization","data","_error$response","_error$response$data","message","markAsRead","id","patch","map","_id","isRead","console","deleteMessage","window","confirm","delete","filter","viewMessage","closeMessageDetail","formatDate","dateString","options","year","month","day","hour","minute","Date","toLocaleDateString","undefined","className","children","length","onClick","name","subject","substring","createdAt","email","href"],"sources":["/Users/deepak/Seraune/frontend/src/admin/pages/MessagesPage.js"],"sourcesContent":["// frontend/src/admin/pages/MessagesPage.js\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport '../styles/MessagesPage.css';\n\nconst MessagesPage = () => {\n  const [messages, setMessages] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const [selectedMessage, setSelectedMessage] = useState(null);\n\n  // Fetch messages\n  useEffect(() => {\n    const fetchMessages = async () => {\n      try {\n        const token = localStorage.getItem('token'); // Assuming you store auth token in localStorage\n        \n        const response = await axios.get('/api/messages', {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        });\n        \n        setMessages(response.data.data);\n        setLoading(false);\n      } catch (error) {\n        setError(error.response?.data?.message || 'Error fetching messages');\n        setLoading(false);\n      }\n    };\n    \n    fetchMessages();\n  }, []);\n\n  // Mark message as read\n  const markAsRead = async (id) => {\n    try {\n      const token = localStorage.getItem('token');\n      \n      await axios.patch(`/api/messages/${id}/read`, {}, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      \n      // Update local state\n      setMessages(messages.map(message => \n        message._id === id ? { ...message, isRead: true } : message\n      ));\n      \n    } catch (error) {\n      console.error('Error marking message as read:', error);\n    }\n  };\n\n  // Delete message\n  const deleteMessage = async (id) => {\n    if (!window.confirm('Are you sure you want to delete this message?')) return;\n    \n    try {\n      const token = localStorage.getItem('token');\n      \n      await axios.delete(`/api/messages/${id}`, {\n        headers: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n      \n      // Update local state\n      setMessages(messages.filter(message => message._id !== id));\n      \n      // Close message detail if it's the deleted one\n      if (selectedMessage && selectedMessage._id === id) {\n        setSelectedMessage(null);\n      }\n      \n    } catch (error) {\n      console.error('Error deleting message:', error);\n    }\n  };\n\n  // View message details\n  const viewMessage = (message) => {\n    setSelectedMessage(message);\n    \n    // If message is unread, mark it as read\n    if (!message.isRead) {\n      markAsRead(message._id);\n    }\n  };\n\n  // Close message detail\n  const closeMessageDetail = () => {\n    setSelectedMessage(null);\n  };\n\n  // Format date\n  const formatDate = (dateString) => {\n    const options = { year: 'numeric', month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' };\n    return new Date(dateString).toLocaleDateString(undefined, options);\n  };\n\n  if (loading) return <div className=\"loading\">Loading messages...</div>;\n  if (error) return <div className=\"error-message\">Error: {error}</div>;\n\n  return (\n    <div className=\"admin-messages-page\">\n      <h1>Messages</h1>\n      \n      <div className=\"messages-container\">\n        <div className=\"messages-list\">\n          {messages.length === 0 ? (\n            <div className=\"no-messages\">No messages yet</div>\n          ) : (\n            messages.map(message => (\n              <div \n                key={message._id} \n                className={`message-item ${message.isRead ? '' : 'unread'} ${selectedMessage && selectedMessage._id === message._id ? 'selected' : ''}`}\n                onClick={() => viewMessage(message)}\n              >\n                <div className=\"message-sender\">{message.name}</div>\n                <div className=\"message-subject\">{message.subject}</div>\n                <div className=\"message-preview\">\n                  {message.message.length > 60 \n                    ? `${message.message.substring(0, 60)}...` \n                    : message.message}\n                </div>\n                <div className=\"message-date\">{formatDate(message.createdAt)}</div>\n              </div>\n            ))\n          )}\n        </div>\n        \n        {selectedMessage && (\n          <div className=\"message-detail\">\n            <div className=\"message-detail-header\">\n              <button className=\"close-button\" onClick={closeMessageDetail}>Ã—</button>\n              <h2>{selectedMessage.subject}</h2>\n              <div className=\"message-meta\">\n                <span className=\"from\">From: {selectedMessage.name} &lt;{selectedMessage.email}&gt;</span>\n                <span className=\"date\">Date: {formatDate(selectedMessage.createdAt)}</span>\n              </div>\n            </div>\n            \n            <div className=\"message-body\">\n              {selectedMessage.message}\n            </div>\n            \n            <div className=\"message-actions\">\n              <button \n                className=\"delete-button\"\n                onClick={() => deleteMessage(selectedMessage._id)}\n              >\n                Delete\n              </button>\n              <a \n                href={`mailto:${selectedMessage.email}?subject=Re: ${selectedMessage.subject}`}\n                className=\"reply-button\"\n              >\n                Reply\n              </a>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default MessagesPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}